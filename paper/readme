<<< 모듈러 로봇 Thorvald II의 소프트웨어 구성요소 >>

이 백서에서는 Thorvald II 모바일 로봇 플랫폼의 주요 소프트웨어 구성 요소를 제시합니다. 
Thorvald II는 임의의 모양과 크기의 로봇을 만들기 위해 저자가 개발한 모듈식 시스템입니다.
주로 농업 영역을 위해. 여러 로봇이 제작되어 현재 작동 중입니다.
유럽의 다양한 위치에 있는 농장과 대학. 로봇은 다양한 형태를 취할 수 있으며 차동 구동, Ackermann 스티어링, 4륜 구동, 모든 번호의 4륜 스티어링용으로 구성
따라서 소프트웨어는 구성에 구애받지 않아야 합니다. 
이 논문에서 우리는 이전에는 볼 수 없었던 로봇 구성을 간단하게 설정할 수 있는 아키텍처입니다. 
선보인 software는 독자가 사용할 수 있는 ROS 패키지 모음으로 구성됩니다. 
이러한 패키지는 사용자가 자신의 로봇 구성을 만들고 제공된 도구를 사용하여 Gazebo에서 이러한 로봇을 시뮬레이션할 수 있습니다.
제시된 패키지는 Thorvald 로봇과 함께 사용하도록 만들어졌지만, 자신의 로봇을 개발하고 다양한 로봇을 테스트하는 데 관심이 있는 사람들에게 유용합니다.
특정 설계를 결정하기 전에 시뮬레이션에서 구성을 수행합니다. 
로봇을 생성하기 위해 사용자는 모듈을 나열합니다. 하나의 단일 구성 파일에 주요 매개변수를 포함하고 이를 시작 시 로봇에 대한 입력으로 제공합니다.
예제 구성 파일은 패키지 내에 제공됩니다. 이 문서에서 우리는 주요 측면에 대해 논의합니다 ROS 패키지 및 설치 및 사용 방법에 대한 업데이트된 정보를 찾을 수 있는 위치에 대한 지침 제공

1. Introduction
로봇이 정형 환경에서 비정형 환경으로 이동함에 따라 새로운 과제가 등장합니다. 이것은 원래 인간 작업자를 위한 기존 인프라에 적응해야 하는 모바일 로봇의 경우 특히 그렇습니다.
인간은 새로운 환경을 평가하고 적응할 수 있는 민첩한 생물입니다.

로봇의 경우에는 그렇지 않습니다. 많은 경우 로봇 환경이 약간만 변경되어도 로봇이 무용지물이 될 수 있습니다.
여기서 로봇의 기계적 및 운동학적 설계의 유연성은 작업 환경의 변화를 수용하도록 로봇을 수정할 수 있기 때문에 유용합니다.

농업은 일률적으로 적용되는 것이 적절하지 않은 영역입니다.
농장은 서로 다른 경향이 있으므로 농업에서 볼 수 있는 모든 생산 유형을 처리하려면 다양한 모양과 크기의 로봇이 필요합니다.

이 문서에서는 환경 특정 구성으로 조립할 수 있는 모듈식 로봇 클래스용 소프트웨어 패키지를 제시합니다.

이 작업의 주요 동기는 농업 영역이었지만 제시된 자료는 광범위한 응용 분야에서 사용될 수 있습니다.

인구 증가와 환경 친화적인 생산에 대한 수요 증가로 인한 미래 수요를 충족하려면 식품 생산이 효율성을 높이고 환경에 미치는 영향을 줄여야 한다는 것은 잘 알려져 있습니다.

고정밀, 에너지 효율적인 로봇을 현장과 온실에 도입하는 것이 솔루션의 일부가 될 수 있습니다.

로봇을 농장에 도입하기 위한 학문적, 상업적 노력이 증가하고 있으며 매년 새롭고 흥미로운 로봇이 여러 개 등장합니다.

van Henten et al(2002)의 초기 로봇은 온실에서 오이를 수확하도록 설계되었습니다.
이 로봇은 식물 열 사이에 있는 가열 파이프를 이동용 레일로 사용했습니다.
다른 2개의 초기 로봇은 API 로봇(Bak and Jakobsen(2004))과 BoniRob(Ruckelshausen 및 et.al(2009))로, 둘 다 4륜 구동 및 4륜 조향이 있는 open-fileds 로봇입니다.

일부 농업 로봇은 다양한 도구를 장착할 수 있는 차동 구동 로봇 캐리어인 AgBot II(Bawden et al(2014))와 같이 여러 작업을 해결하는 데 사용되도록 설계되었습니다.

다른 로봇은 처리량이 많은 작물 표현형 로봇인 Robotanist(Mueller-Sim et al(2017))와 같은 한 유형의 작업을 해결하는 데 특화되어 있습니다.
수확(Lehnert et al.(2017)) 및 가지치기(Botterill et al.(2016))를 위한 다양한 로봇도 개발되었으며 농장 내 운반을 위한 다른 로봇도 개발되었습니다. 
예를 들어 Bin-Dog(Ye et al(2017))는 과수원의 쓰레기통 관리를 위한 로봇 플랫폼입니다.

대부분의 농업용 로봇에 공통적으로 적용되는 것은 특정 환경에서 작동하도록 설계되었다는 것입니다.
또한 많은 로봇은 해당 환경에서 단 하나의 특정 작업만 해결하도록 되어 있습니다.
모바일 로봇은 작동 위치에 따라 디자인이 크게 다를 수 있으며 일반적으로 사용자 정의 옵션을 거의 또는 전혀 제공하지 않습니다.

로봇 시스템을 상용화하려는 사람들이 직면한 몇 가지 문제 중 하나는 농장 기반 시설에서 발견되는 큰 변화입니다.

다른 작물을 재배하는 농장 간에 차이가 있을 수 있지만 동일한 작물을 재배하는 농부도 다른 시스템을 사용할 수 있습니다.

한 가지 예는 딸기 생산입니다.
농부는 오픈 필드, 폴리 터널 또는 온실 딸기를 재배할 수 있습니다.
이것은 로봇에 대한 세 가지 매우 다른 환경을 나타냅니다. 이 세 가지 환경에는 각각 큰 변화가 있을 수 있습니다.
폴리터널에서 딸기를 재배하는 한 농부는 땅의 침대에서 작물을 재배할 수 있고, 다른 농부는 기둥에 장착된 탁상 위에서 작물을 재배할 수 있으며, 또 다른 농부는 천장에 매달린 쟁반에 작물을 재배할 수 있습니다.

다음과 같은 경우에도 큰 편차가 있습니다. 다양한 딸기 품종, 줄 간격의 변화, 터널 디자인의 변화 등.

위의 예를 보면 농업 환경에서 발견되는 변화를 수용하기 위해 로봇 설계에 약간의 유연성이 추가되어야 한다고 주장할 수 있습니다. 이것이 이면의 생각이었다

저자가 만든 Thorvald II 로봇 시스템. Thorvald II 로봇은 모듈로 조립됩니다.

광범위한 농업 환경. 이 모듈을 다양한 방식으로 결합하여 다양한 로봇을 만들 수 있습니다. 모듈식 설계를 사용하여 로봇은 새로운 환경에서 새로운 작업을 위해 신속하게 생성하거나 재구축할 수 있습니다.
여러 로봇이 이 모듈에서 조립되어 하나의 시스템에서 작동하고 있습니다.

이 백서에서 우리는 로봇 소프트웨어의 주요 구성 요소와 Gazebo(Koenig and Howard)에서 임의의 Thorvald II 로봇을 시뮬레이션하는 데 사용할 수 있는 
ROS(Robot Operating System)용 패키지의 초기 릴리스(Quigley and et.al(2009))를 제시합니다. (2004)).

여기에는 Gazebo용 플러그인이 포함된 패키지, URDF(Unified Robot Description Format)로 로봇 설명을 생성하기 위한 패키지, 질량 및 관성 속성에 대한 태그 포함, 시뮬레이션용 패키지가 포함됩니다.
로봇 베이스, 원격 조작용 패키지, 시뮬레이션 시작을 위한 예제 실행 파일이 포함된 패키지 등이 있습니다.
속도 명령을 게시할 때
실제 또는 시뮬레이션된 로봇, 로봇은 현재 로봇 구성에 대한 올바른 관절 명령을 계산하고 실제 또는 시뮬레이션된 관절 상태를 기반으로 속도 추정치를 출력합니다.
로봇은 하나의 구성 파일에서 생성되며 사용자는 제공된 로봇 구성 중 하나를 복사하거나 모듈을 자유롭게 조합하여 생성할 수 있습니다.
로봇을 자신의 사양에 맞게 조정합니다.

따라서 ROS 패키지는 이 로봇이 Thorvald 모듈을 기반으로 하지 않더라도 자신의 로봇을 만들 계획이고 시뮬레이션에서 다양한 로봇 설계를 테스트하기 위한 도구를 찾고 있는 사람들에게 유용합니다.

이 문서는 다음과 같이 구성됩니다. 섹션 2에서는 Thorvald II 로봇 시스템 하드웨어에 대한 개요를 제공하고 제시된 ROS 패키지에 대해 설명합니다.

섹션 3에서는 속도 명령 및 주행 거리 측정을 다루고 섹션 4에서는 임의의 Thorvald 로봇을 시뮬레이션하는 접근 방식을 설명합니다.
마지막으로 논문을 마무리하고 섹션 5에서 제시된 ROS 패키지를 설치하는 방법에 대한 정보를 제공합니다.


2 The Thorvald II Modular Robot

Thorvald II는 주로 농업 영역을 위한 맞춤형 로봇을 만들기 위한 시스템입니다. 이 시스템은 다양한 모양과 속성을 가진 다양한 로봇을 만들기 위해 다양한 방식으로 조립할 수 있는 소수의 모듈을 기반으로 합니다.

다른 농장의 여러 프로젝트에서 작업하면서 저자는 둘 이상의 농장 환경에 맞게 쉽게 재구성할 수 있는 로봇의 필요성을 보았습니다.

따라서 Thorvald II 시스템이 만들어졌습니다.
로봇을 만드는 이 모듈식 접근 방식은 새로운 환경별 로봇을 만들 때 시간과 비용을 절약하는 데 도움이 됩니다.

예를 들어 연구 프로젝트가 끝나면 프로젝트에 사용된 로봇이 다른 작물이나 다른 농장에서 새로운 작업을 위해 쉽게 재건됩니다.

여러 로봇이 Thorvald II 모듈로 구성되었으며 그 중 소수는 그림 1과 2에서 볼 수 있습니다. 이 로봇은 유럽의 다양한 위치에서 다양한 유형의 작물에서 노지, 폴리터널 및 온실에서 작동하고 있습니다.
많은 로봇이 환경에서 환경으로 이동할 때 자주 재구축됩니다.

2.1 Robot Hardware

Thorvald 로봇을 만들거나 재구성할 때 모듈은 간단한 기계 및 전기 인터페이스를 통해 연결됩니다.

로봇의 구조 프레임은 대부분의 경우 알루미늄 파이프와 클램프를 사용하여 만들어지며, 프레임에 모듈을 부착하기 위한 간단한 기계적 연결을 제공하는 특수 클램프가 있습니다.

모듈 내에 복잡성이 포함되어 있기 때문에 예를 들어 파이프나 판금을 함께 용접하여 맞춤형 프레임을 생성할 수도 있습니다.
이것은 그림 1의 배경에 있는 키 큰 로봇과 그림 2a에 묘사된 낮은 온실 로봇과 같이 특별한 프레임 요구 사항을 가진 로봇을 만들 때 수행됩니다.

Thorvald II 시스템의 기계적 및 전기적 측면은 Grimstad and From(2017a) 및 Grimstad and From(2017b)에 자세히 설명되어 있습니다.
이 문서와 관련된 모듈은 아래에 간략하게 설명되어 있습니다. 일부 모듈은 그림 3에 나와 있습니다.

그림 3: 가장 중요한 로봇 모듈. (A) 배터리 인클로저, (B) 드라이브 모듈, (C) 스티어링 모듈, (D) 서스펜션 모듈.

2.1.1 Battery Enclosure
배터리 인클로저 모듈은 배터리와 전자 장치를 수용하며 다른 모듈에 대한 전원 및 통신 연결 지점으로 사용됩니다. 여러 배터리 인클로저를 병렬로 연결하여 로봇 범위를 늘릴 수 있습니다.

2.1.2 Drive Module
구동 모듈은 추진에 사용됩니다. 모듈은 출력에 플랜지가 있는 모터 및 기어 어셈블리를 고정합니다. 휠이 이 플랜지에 연결됩니다.

2.1.3 Steering Module
조향 모듈은 출력 샤프트에 플랜지가 있는 모터 및 기어 어셈블리를 고정합니다. 이 플랜지는 드라이브 모듈에 연결됩니다. 조향 모듈은 서보 모터의 역할을 하며 구동 모듈을 수직축을 중심으로 회전시키며,
원하는 방향으로 구동 휠을 가리킵니다.

2.1.4 Suspension Module
서스펜션 모듈에는 충격 흡수 장치가 장착되어 있어 수직 이동이 가능합니다. 이 모듈은 조향 모듈과 로봇 프레임 사이에 연결되어 바퀴를 지면에 고정하는 데 도움이 되므로 고르지 않은 지형에서 로봇의 견인력을 높일 수 있습니다.

2.1.5 Passive Wheel Modules
다양한 패시브 휠 모듈을 사용하여 로봇을 지지할 수 있습니다. 한 가지 예는 그림 1의 배경에서 볼 수 있는 키 큰 차동 구동 로봇의 후방 캐스터 휠이고, 다른 예는 후방 지지 휠입니다.
그림 2b의 1륜 구동 로봇에서 볼 수 있습니다.


2.2 ROS Packages
로봇 운영 체제(ROS)는 로봇의 소프트웨어 프레임워크로 사용됩니다.
로봇의 소프트웨어는 모듈식 하드웨어를 지원하도록 설계되었습니다.
이는 모든 Thorvald II 로봇이 로봇 베이스를 구동하고 관절 상태에서 주행 거리를 계산하는 등의 작업을 위해 동일한 소프트웨어를 실행한다는 것을 의미합니다. 
한 로봇을 다른 로봇과 구분하는 유일한 측면은 하나의 단일 구성 파일입니다.

여러 ROS 패키지가 커뮤니티에 제공되었습니다. 이 문서와 관련된 패키지는 다음과 같습니다.
-> thorvald_base는 실제 로봇을 시뮬레이션하거나 통신합니다.
-> thorvald_teleop은 원격 작동을 위한 하드웨어 독립 노드를 제공합니다.
-> thorvald_gazebo_plugin은 다음을 위한 플러그인을 제공합니다. 로봇 시뮬레이션용 전망대.
-> thorvald_model은 로봇 구성 파일에서 로봇 설명을 생성하기 위한 스크립트를 제공합니다. 또한 예제 로봇 구성 파일도 제공합니다.
-> thorvald_can_device는 모터 드라이브 및 배터리와 같은 다양한 유형의 CAN 장치에 대한 인터페이스를 제공합니다. 또한 이러한 인터페이스를 구현하는 라이브러리를 제공합니다.
-> thorvald_twist_mux는 동일한 이름의 외부 패키지에서 트위스트 멀티플렉서 트위스트 먹스에 대한 구성 매개변수를 제공합니다.
-> thorvald_bringup은 몇 가지 일반적인 로봇 구성과 그렇지 않은 로봇 구성을 시작하기 위한 몇 가지 유용한 예제 시작 파일을 제공합니다.

그림 4는 실제 로봇의 단순화된 설정을 보여줍니다.
여기에 속도 명령에 대한 두 가지 주제가 있습니다.
telop_joy/cmd_vel 및 auto_nav/cmd_vel.
telop_joy/cmd_vel은 원격 조작에 사용되며,
thorvald teleop 패키지의 telop 노드에 의해 게시되는 반면 auto nav/cmd vel은 자율 탐색 중 명령에 사용되는 하나 이상의 주제에 대한 자리 표시자입니다.

멀티플렉서 노드는 속도 명령 주제를 구독하고 가장 높은 값을 가진 주제에서 메시지를 게시합니다.
twis_mux/cmd_vel에 우선 순위(및 현재 게시 중인 메시지). thorvald_base 패키지의 base_driver가 이 주제를 구독합니다.

노드는 관절 명령을 계산하여 로봇 베이스로 보냅니다.
노드는 또한 피드백을 받습니다.
로봇 속도를 추정하는 데 사용하는 베이스입니다. 속도 추정치는 odometry/base_raw에 게시됩니다.
시뮬레이션된 로봇의 경우 base_driver는 내부적으로 관절 상태를 시뮬레이션하고 이로부터 로봇 속도를 추정합니다.

모터 컨트롤러 또는 배터리를 포함하는 모듈은 CAN(Controller Area Network)에 연결됩니다.
이러한 모듈의 주소는 로봇 구성 파일에 지정됩니다.
다른 장치가 동일한 CAN에 연결되어 있으면 base_driver를 사용하여 can_frames_device_t 및 이러한 장치와의 통신을 릴레이할 수도 있습니다.
can_frames_device_r 주제 각각.
이것은 다음과 같은 경우에 유용합니다.
로봇에는 CAN을 통해 통신하는 도구가 장착되어 있습니다.

그림 4: ROS 노드 및 로봇 기반 하드웨어의 단순화된 다이어그램


2.3 Robot Configuration
각 로봇 구성에는 구성별 파일. 이 파일은 로봇의 좌표 프레임에서의 위치, 통신 ID, 시뮬레이션 매개변수 등과 같은 관련 매개변수와 함께 주어진 로봇에 사용된 모듈을 나열합니다.
구성 파일은 또한 베이스 구동을 담당하는 노드인 base_driver가 조인트 계산에 사용해야 하는 운동학적 모델 플러그인을 지정합니다.
명령 및 주행 거리 측정.

사용자가 선택한 구성 파일에서 찾은 매개변수는 시작 시 ROS 매개변수 서버에 로드됩니다.
ROS 네트워크의 모든 노드에서 사용할 수 있습니다.

사용자는 새 구성 파일을 쉽게 생성하거나 기존 파일을 수정할 수 있으며 일반적으로 선호하는 하드웨어 구성 각각에 대해 하나의 파일을 갖고 로봇이 재구축을 진행하면서 이들 사이를 전환합니다.
구성 파일의 일부는 그림 5에서 볼 수 있습니다.

그림 5: 로봇 구성 파일의 발췌. 로봇을 만드는 데 사용되는 모듈은 주요 매개변수와 함께 여기에 나열됩니다.


3 Driving the Robot Base
로봇은 다양한 형태를 취할 수 있으므로 소프트웨어는 다양한 운동학적 속성을 가진 로봇을 처리할 수 있어야 합니다.
로봇은 조인트 컴포지션을 계산할 수 있어야 합니다.
로봇 좌표계에서 주어진 구성 독립적인 속도 명령에서 명령을 내리고 관절 피드백을 기반으로 동일한 좌표계에서 로봇의 실제 속도를 추정할 수 있어야 합니다.
여기에서 로봇이 이를 어떻게 처리하는지 살펴보겠습니다.

3.1 Base Driver Node
